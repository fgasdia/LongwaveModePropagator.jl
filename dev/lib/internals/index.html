<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Internals · LongwaveModePropagator</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">LongwaveModePropagator</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox"/><label class="tocitem" for="menuitem-2"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../generated/basic/">Introduction to defining scenarios</a></li><li><a class="tocitem" href="../../generated/io/">File-based I/O</a></li><li><a class="tocitem" href="../../generated/meshgrid/">Mesh grid for mode finding - Part 1</a></li><li><a class="tocitem" href="../../generated/meshgrid2/">Mesh grid for mode finding - Part 2</a></li><li><a class="tocitem" href="../../generated/integratedreflection/">Solvers for ionosphere reflection coefficient</a></li><li><a class="tocitem" href="../../generated/wavefieldintegration/">Wavefield integration</a></li><li><a class="tocitem" href="../../generated/magneticfield/">Magnetic field direction</a></li><li><a class="tocitem" href="../../generated/interpretinghpbeta/">Interpreting h′ and β</a></li><li><a class="tocitem" href="../../generated/multiplespecies/">Multiple ionospheric species</a></li><li><a class="tocitem" href="../../generated/ground/">Ground</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox" checked/><label class="tocitem" for="menuitem-3"><span class="docs-label">Library</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../public/">Public Interface</a></li><li class="is-active"><a class="tocitem" href>Internals</a></li></ul></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Library</a></li><li class="is-active"><a href>Internals</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Internals</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/master/docs/src/lib/internals.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Internals"><a class="docs-heading-anchor" href="#Internals">Internals</a><a id="Internals-1"></a><a class="docs-heading-anchor-permalink" href="#Internals" title="Permalink"></a></h1><p>Documentation of all <code>const</code>s, <code>struct</code>s, <code>function</code>s, etc.</p><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.AbstractDipole" href="#LongwaveModePropagator.AbstractDipole"><code>LongwaveModePropagator.AbstractDipole</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">AbstractDipole &lt;: Antenna</code></pre><p>Abstract type for dipole antennas.</p><p>Subtypes of <code>AbstractDipole</code> have an orientation <code>azimuth_angle</code> (<span>$ϕ$</span>) and <code>inclination_angle</code> (<span>$γ$</span>) where</p><table><tr><th style="text-align: center">[rad]</th><th style="text-align: center">ϕ</th><th style="text-align: center">γ</th></tr><tr><td style="text-align: center">0</td><td style="text-align: center">end fire</td><td style="text-align: center">vertical</td></tr><tr><td style="text-align: center">π/2</td><td style="text-align: center">broadside</td><td style="text-align: center">horizontal</td></tr></table><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Angles describe the orientation of the antenna, not the radiation pattern.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/Antennas.jl#L8-L24">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.Antenna" href="#LongwaveModePropagator.Antenna"><code>LongwaveModePropagator.Antenna</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">Antenna</code></pre><p>Abstract supertype for all antenna-like types. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/Antennas.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.bookerquartic" href="#LongwaveModePropagator.bookerquartic"><code>LongwaveModePropagator.bookerquartic</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">bookerquartic(ea::EigenAngle, M)
bookerquartic(T::TMatrix)</code></pre><p>Compute roots <code>q</code> and the coefficients <code>B</code> of the Booker quartic described by the susceptibility tensor <code>M</code> or <code>T</code> matrix.</p><p><strong>References</strong></p><p>[Budden1988]: K. G. Budden, “The propagation of radio waves: the theory of radio     waves of low power in the ionosphere and magnetosphere,” First paperback edition.     New York: Cambridge University Press, 1988.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/bookerquartic.jl#L9-L21">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.bookerreflection" href="#LongwaveModePropagator.bookerreflection"><code>LongwaveModePropagator.bookerreflection</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">bookerreflection(ea::EigenAngle, M::SMatrix{3,3})
bookerreflection(ea::EigenAngle, e)</code></pre><p>Compute the ionosphere reflection coefficient matrix for a sharply bounded ionosphere from 4×2 wavefields matrix <code>e</code> or the susceptibility matrix <code>M</code>.</p><p>The ionosphere reflection coefficient matrix is computed from a ratio of the downgoing to upgoing plane waves in the free space beneath the ionosphere [Budden1988] pg. 307. These are obtained from the two upgoing characteristic waves found from the Booker quartic. Each make up a column of <code>e</code>.</p><p class="math-container">\[R =
    \begin{pmatrix}
        Ce₁[4] - e₁[1] &amp;  Ce₂[4] - e₂[1] \\
       -Ce₁[2] + e₁[3] &amp; -Ce₂[2] + e₂[3]
    \end{pmatrix}
    \begin{pmatrix}
        Ce₁[4] + e₁[1] &amp;  Ce₂[4] + e₂[1] \\
       -Ce₁[2] - e₁[3] &amp; -Ce₂[2] - e₂[3]
    \end{pmatrix}^{-1}\]</p><p>The reflection coefficient matrix for the sharply bounded case is commonly used as a starting solution for integration of the reflection coefficient matrix through the ionosphere.</p><p><strong>References</strong></p><p>[Budden1988]: K. G. Budden, “The propagation of radio waves: the theory of radio     waves of low power in the ionosphere and magnetosphere,” First paperback edition.     New York: Cambridge University Press, 1988.</p><p><strong>Extended help</strong></p><p>The set of horizontal field components <span>$e = (Ex, -Ey, Z₀Hx, Z₀Hy)ᵀ$</span> can be separated into an upgoing and downgoing wave, each of which is generally elliptically polarized. A ratio of the amplitudes of these two waves give a reflection coefficient, except it would only apply for an incident wave of that particular elliptical polarization. However, the first set of fields can be linearly combined with a second independent solution for the fields, which will generally have a elliptical polarization than the first. Two linear combinations of the two sets of fields are formed with unit amplitude, linearly polarized incident waves. The reflected waves then give the components <span>$R₁₁$</span>, <span>$R₂₁$</span> or <span>$R₁₂$</span>, <span>$R₂₂$</span> for the incident wave in the plane of incidence and perpendicular to it, respectively [Budden1988] pg 552.</p><p>The process for determining the reflection coefficient requires resolving the two sets of fields <span>$e₁$</span> and <span>$e₂$</span> into the four linearly polarized vacuum modes. The layer of vacuum can be assumed to be so thin that it does not affect the fields. There will be two upgoing waves and two downgoing waves, each which has one <span>$E$</span> and one <span>$H$</span> in the plane of incidence. If <span>$f₁, f₂, f₃, f₄$</span> are the complex amplitudes of the four component waves, then in matrix notation <span>$e = Lf$</span> where <span>$L$</span> is the appropriate transformation matrix.</p><p>For <span>$e₁$</span> and <span>$e₂$</span>, we can find the corresponding vectors <span>$f1$</span> and <span>$f2$</span> by <span>$f1 = L⁻¹e₁$</span>, <span>$f2 = L⁻¹e₂$</span> where the two column vectors are partitioned such that <span>$f1 = (u1, d1)ᵀ$</span> and <span>$f2 = (u2, d2)ᵀ$</span> for upgoing and downgoing 2-element vectors <span>$u$</span> and <span>$d$</span>. From the definition of the reflection coefficient <span>$R$</span>, <span>$d = Ru$</span>. Letting <span>$U = (u1, u2)$</span>, <span>$D = (d1, d2)$</span>, then <span>$D = RU$</span> and the reflection coefficient is <span>$R = DU¹$</span>. Because the reflection coefficient matrix is a ratio of fields, either <span>$e₁$</span> and/or <span>$e₂$</span> can be independently multiplied by an arbitrary constant and the value of <span>$R$</span> is unaffected.</p><p>This function directly computes <span>$D$</span> and <span>$U$</span> and solves for <span>$R$</span> using the right division operator <code>R = D/U</code>.</p><p>For additional details, see [Budden1988], chapter 18, section 7.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/bookerquartic.jl#L344-L411">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.bookerreflection-Tuple{EigenAngle, Any, LongwaveModePropagator.Dθ}" href="#LongwaveModePropagator.bookerreflection-Tuple{EigenAngle, Any, LongwaveModePropagator.Dθ}"><code>LongwaveModePropagator.bookerreflection</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">bookerreflection(ea::EigenAngle, M, ::Dθ)</code></pre><p>Compute the ionosphere reflection coefficient matrix <span>$R$</span> for a sharply bounded ionosphere with susceptibility tensor <code>M</code>, as well as its derivative <span>$dR/dθ$</span> returned as the tuple <code>(R, dR)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/bookerquartic.jl#L433-L439">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.bookerwavefields" href="#LongwaveModePropagator.bookerwavefields"><code>LongwaveModePropagator.bookerwavefields</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">bookerwavefields(ea::EigenAngle, M)
bookerwavefields(T::TMatrix)</code></pre><p>Compute the two-column wavefields matrix <code>e</code> from the ionosphere with susceptibility tensor <code>M</code> or <code>T</code> matrix for the two upgoing wavefields.</p><p>The first column of <code>e</code> is the evanescent wave and the second is the travelling wave.</p><p class="math-container">\[e =
    \begin{pmatrix}
         Ex₁  &amp;  Ex₂ \\
        -Ey₁  &amp; -Ey₂ \\
         Hx₁  &amp;  Hx₂ \\
         Hy₁  &amp;  Hy₂
    \end{pmatrix}\]</p><p>This function solves the eigenvalue problem <span>$Te = qe$</span>. First, the Booker quartic is solved for the roots <code>q</code>. Then they are sorted so that the roots associated with the two upgoing waves can be selected. <code>e</code> is solved as the eigenvectors for the two <code>q</code>s. An analytical solution is used where <code>e[2,:] = 1</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/bookerquartic.jl#L226-L249">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.bookerwavefields-Tuple{LongwaveModePropagator.TMatrix, Any, LongwaveModePropagator.Dθ}" href="#LongwaveModePropagator.bookerwavefields-Tuple{LongwaveModePropagator.TMatrix, Any, LongwaveModePropagator.Dθ}"><code>LongwaveModePropagator.bookerwavefields</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">bookerwavefields(ea::EigenAngle, M, ::Dθ)
bookerwavefields(T::TMatrix, dT, ::Dθ)</code></pre><p>Compute the two-column wavefields matrix <code>e</code> as well as its derivative with respect to <span>$θ$</span>, returned as a tuple <code>(e, de)</code> for the ionosphere with susceptibility tensor <code>M</code> or <code>T</code> matrix and its derivative with respect to <span>$θ$</span>, <code>dT</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/bookerquartic.jl#L285-L292">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.dbookerquartic" href="#LongwaveModePropagator.dbookerquartic"><code>LongwaveModePropagator.dbookerquartic</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">dbookerquartic(ea::EigenAngle, M, q, B)
dbookerquartic(T::TMatrix, dT, q, B)</code></pre><p>Compute derivative <code>dq</code> of the Booker quartic roots <code>q</code> with respect to <span>$θ$</span> for the ionosphere described by susceptibility tensor <code>M</code> or <code>T</code> matrix.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/bookerquartic.jl#L80-L86">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.sortquarticroots!-Tuple{Any}" href="#LongwaveModePropagator.sortquarticroots!-Tuple{Any}"><code>LongwaveModePropagator.sortquarticroots!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">sortquarticroots!(q)</code></pre><p>Sort array of quartic roots <code>q</code> in place such that the first two correspond to upgoing waves and the latter two correspond to downgoing waves.</p><p>General locations of the four roots of the Booker quartic on the complex plane corresponding to the:</p><pre><code class="language-none">1) upgoing evanescent wave
2) upgoing travelling wave
3) downgoing evanescent wave
4) downgoing travelling wave</code></pre><pre><code class="language-none">          Im
      3 . |
          |
          |
  . 4     |
 ------------------Re
          |      . 2
          |
          |
          | . 1</code></pre><p>Based on [Pitteway1965] fig. 5.</p><p><strong>References</strong></p><p>[Pitteway1965]: M. L. V. Pitteway, “The numerical calculation of wave-fields, reflexion     coefficients and polarizations for long radio waves in the lower ionosphere. I.,” Phil.     Trans. R. Soc. Lond. A, vol. 257, no. 1079, pp. 219–241, Mar. 1965,     doi: 10.1098/rsta.1965.0004.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/bookerquartic.jl#L148-L183">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.upgoing-Tuple{Complex}" href="#LongwaveModePropagator.upgoing-Tuple{Complex}"><code>LongwaveModePropagator.upgoing</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">upgoing(q)</code></pre><p>Calculate the absolute angle of <code>q</code> in radians from 315°×π/180 on the complex plane. Smaller values indicate upgoing waves.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/bookerquartic.jl#L130-L135">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.isless-Tuple{EigenAngle, EigenAngle}" href="#Base.isless-Tuple{EigenAngle, EigenAngle}"><code>Base.isless</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">isless(x::EigenAngle, y::EigenAngle)</code></pre><p>Calls <code>Base.isless</code> for complex <code>EigenAngle</code> by <code>real</code> and then <code>imag</code> component.</p><p>By defining <code>isless</code>, calling <code>sort</code> on <code>EigenAngle</code>s sorts by real component first and imaginary component second.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/EigenAngles.jl#L45-L52">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.isdetached-Tuple{EigenAngle, Frequency}" href="#LongwaveModePropagator.isdetached-Tuple{EigenAngle, Frequency}"><code>LongwaveModePropagator.isdetached</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">isdetached(ea::EigenAngle, frequency::Frequency; params=LMPParams())</code></pre><p>Return <code>true</code> if this is likely an earth detached (whispering gallery) mode according to the criteria in [Pappert1981] eq. 1 with the additional criteria that the frequency be above 100 kHz.</p><p><strong>References</strong></p><p>[Pappert1981]: R. A. Pappert, “LF daytime earth ionosphere waveguide calculations,” Naval     Ocean Systems Center, San Diego, CA, NOSC/TR-647, Jan. 1981.     [Online]. Available: https://apps.dtic.mil/docs/citations/ADA096098.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/EigenAngles.jl#L73-L85">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.AirborneTransmitter" href="#LongwaveModePropagator.AirborneTransmitter"><code>LongwaveModePropagator.AirborneTransmitter</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">AirborneTransmitter{A&lt;:Antenna} &lt;: Emitter</code></pre><p>Similar to <code>Transmitter</code> except it also contains an <code>altitude</code> field in meters.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/Emitters.jl#L100-L104">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.Emitter" href="#LongwaveModePropagator.Emitter"><code>LongwaveModePropagator.Emitter</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">Emitter</code></pre><p>Abstract type for types that energize the waveguide with electromagnetic energy.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/Emitters.jl#L32-L36">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.dip-Tuple{BField}" href="#LongwaveModePropagator.dip-Tuple{BField}"><code>LongwaveModePropagator.dip</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">dip(b::BField)</code></pre><p>Return the dip angle in radians from <code>b</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/Geophysics.jl#L109-L113">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.gyrofrequency-Tuple{Any, Any, Any}" href="#LongwaveModePropagator.gyrofrequency-Tuple{Any, Any, Any}"><code>LongwaveModePropagator.gyrofrequency</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">gyrofrequency(q, m, B)
gyrofrequency(s::Species, b::BField)</code></pre><p>Return the <em>signed</em> gyrofrequency <span>$Ω = qB/m$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/Geophysics.jl#L269-L274">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.magnetoionicparameters-Tuple{Any, Frequency, BField, Species}" href="#LongwaveModePropagator.magnetoionicparameters-Tuple{Any, Frequency, BField, Species}"><code>LongwaveModePropagator.magnetoionicparameters</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">magnetoionicparameters(z, frequency::Frequency, bfield::BField, species::Species)</code></pre><p>Compute the magnetoionic parameters <code>X</code>, <code>Y</code>, and <code>Z</code> for height <code>z</code>.</p><p class="math-container">\[X = N e² / (ϵ₀ m ω²)
Y = e B / (m ω)
Z = ν / ω\]</p><p><strong>References</strong></p><p>[Budden1955a]: K. G. Budden, “The numerical solution of differential equations governing     reflexion of long radio waves from the ionosphere,” Proc. R. Soc. Lond. A, vol. 227,     no. 1171, pp. 516–537, Feb. 1955, pp. 517.</p><p>[Budden1988]: K. G. Budden, “The propagation of radio waves: the theory of radio     waves of low power in the ionosphere and magnetosphere,” First paperback edition.     New York: Cambridge University Press, 1988, pp. 39.</p><p>[Ratcliffe1959]: J. A. Ratcliffe, &quot;The magneto-ionic theory &amp; its applications to the     ionosphere,&quot; Cambridge University Press, 1959.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/Geophysics.jl#L278-L301">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.plasmafrequency-Tuple{Any, Any, Any}" href="#LongwaveModePropagator.plasmafrequency-Tuple{Any, Any, Any}"><code>LongwaveModePropagator.plasmafrequency</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">plasmafrequency(n, q, m)
plasmafrequency(z, s::Species)</code></pre><p>Return the plasma frequency <span>$ωₚ = √(nq²/(ϵ₀m))$</span> for a ``cold&#39;&#39; plasma.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/Geophysics.jl#L260-L265">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.waitsparameter-Tuple{Any, Frequency, BField, Species}" href="#LongwaveModePropagator.waitsparameter-Tuple{Any, Frequency, BField, Species}"><code>LongwaveModePropagator.waitsparameter</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">waitsparameter(z, frequency::Frequency, bfield::BField, species::Species)</code></pre><p>Compute Wait&#39;s conductivity parameter <code>Wr</code>.</p><p class="math-container">\[ωᵣ = Xω²/ν = ωₚ²/ν\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/Geophysics.jl#L329-L337">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.Input" href="#LongwaveModePropagator.Input"><code>LongwaveModePropagator.Input</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">Input</code></pre><p>Abstract supertype for structs carrying information to be input to the model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/IO.jl#L13-L17">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.Output" href="#LongwaveModePropagator.Output"><code>LongwaveModePropagator.Output</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">Output</code></pre><p>Abstract supertype for structs containing information to be output from the model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/IO.jl#L145-L149">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.buildrun" href="#LongwaveModePropagator.buildrun"><code>LongwaveModePropagator.buildrun</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">buildrun(s::BasicInput; mesh=nothing, unwrap=true, params=LMPParams())
buildrun(s::TableInput; mesh=nothing, unwrap=true, params=LMPParams())
buildrun(s::BatchInput; mesh=nothing, unwrap=true, params=LMPParams())</code></pre><p>Build LMP structs from an <code>Input</code> and run <code>LMP</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/IO.jl#L364-L370">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.buildrunsave-Tuple{Any, BatchInput}" href="#LongwaveModePropagator.buildrunsave-Tuple{Any, BatchInput}"><code>LongwaveModePropagator.buildrunsave</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">buildrunsave(outfile, s::BatchInput; append=false, mesh=nothing, unwrap=true, params=LMPParams())</code></pre><p>Similar to <code>buildrun</code>, except it saves results into <code>outfile</code> as <code>s</code> is processed.</p><p>If <code>append=true</code>, this function parses <code>outfile</code> for preexisting results and only runs the remaining scenarios in <code>s</code>. Otherwise, a new <code>BatchOutput</code> is created.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/IO.jl#L463-L470">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.buildwaveguide-Tuple{BasicInput, Any}" href="#LongwaveModePropagator.buildwaveguide-Tuple{BasicInput, Any}"><code>LongwaveModePropagator.buildwaveguide</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">buildwaveguide(s::BasicInput, i)</code></pre><p>Return <code>HomogeneousWaveguide</code> from the <code>i</code>th entry in each field of <code>s</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/IO.jl#L335-L339">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.buildwaveguide-Tuple{TableInput, Any}" href="#LongwaveModePropagator.buildwaveguide-Tuple{TableInput, Any}"><code>LongwaveModePropagator.buildwaveguide</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">buildwaveguide(s::TableInput, i)</code></pre><p>Return <code>HomogeneousWaveguide</code> from the <code>i</code>th entry in each field of <code>s</code> with a linear interpolation over <code>density</code> and <code>collision_frequency</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/IO.jl#L349-L354">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.iscomplete-Tuple{Any}" href="#LongwaveModePropagator.iscomplete-Tuple{Any}"><code>LongwaveModePropagator.iscomplete</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">iscomplete(s)</code></pre><p>Return <code>true</code> if input or output struct <code>s</code> is completely defined, otherwise return <code>false</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/IO.jl#L201-L205">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.parse-Tuple{Any}" href="#LongwaveModePropagator.parse-Tuple{Any}"><code>LongwaveModePropagator.parse</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">parse(file)</code></pre><p>Parse a JSON file compatible with <code>Input</code> or <code>Output</code> types.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/IO.jl#L274-L278">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.validlengths" href="#LongwaveModePropagator.validlengths"><code>LongwaveModePropagator.validlengths</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">validlengths(s)</code></pre><p>Check if field lengths of input <code>s</code> match their number of segments.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/IO.jl#L229-L233">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.BOTTOMHEIGHT" href="#LongwaveModePropagator.BOTTOMHEIGHT"><code>LongwaveModePropagator.BOTTOMHEIGHT</code></a> — <span class="docstring-category">Constant</span></header><section><div><p>Bottom of reflection coefficient integration. <code>LongwaveModePropagator.jl</code> assumes <code>BOTTOMHEIGHT = 0.0</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/LongwaveModePropagator.jl#L149-L152">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.Dθ" href="#LongwaveModePropagator.Dθ"><code>LongwaveModePropagator.Dθ</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Indicates derivative with respect to eigenangle <span>$θ$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/LongwaveModePropagator.jl#L146">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.ModeEquation" href="#LongwaveModePropagator.ModeEquation"><code>LongwaveModePropagator.ModeEquation</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">ModeEquation</code></pre><p>Functions can dispatch on subtypes of <code>ModeEquation</code>, although currently only <code>PhysicalModeEquation</code> is supported.</p><p>Future work might include the <code>ModifiedModeEquation</code> of [Morfitt1976].</p><p><strong>References</strong></p><p>[Morfitt1976]: D. G. Morfitt and C. H. Shellman, “‘MODESRCH’, an improved computer program     for obtaining ELF/VLF/LF mode constants in an Earth-ionosphere waveguide,” Naval     Electronics Laboratory Center, San Diego, CA, NELC/IR-77T, Oct. 1976. [Online].     Available: http://www.dtic.mil/docs/citations/ADA032573.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/LongwaveModePropagator.jl#L129-L143">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.susceptibility-NTuple{4, Any}" href="#LongwaveModePropagator.susceptibility-NTuple{4, Any}"><code>LongwaveModePropagator.susceptibility</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">susceptibility(altitude, frequency, bfield, species; params=LMPParams())
susceptibility(altitude, frequency, w::HomogeneousWaveguide; params=LMPParams())
susceptibility(altitude, me::ModeEquation; params=LMPParams())</code></pre><p>Compute the ionosphere susceptibility tensor <code>M</code> as a <code>SMatrix{3,3}</code> using <code>species.numberdensity</code> and <code>species.collisionfrequency</code> at <code>altitude</code>.</p><p>Multiple species can be passed as an iterable. Use a <code>tuple</code> of <code>Species</code>, rather than a <code>Vector</code>, for better performance.</p><p>If <code>params.earthcurvature == true</code>, <code>M</code> includes a first order correction for earth curvature by means of a fictitious refractive index [Pappert1967].</p><p>The susceptibility matrix is calculated from the constitutive relations presented in [Ratcliffe1959]. This includes the effect of earth&#39;s magnetic field vector and collisional damping on electron motion.</p><p>The tensor is:</p><p class="math-container">\[M = -\frac{X}{U(U²-Y²)}
        \begin{pmatrix}
            U² - x²Y²    &amp; -izUY - xyY² &amp; iyUY - xzY² \\
            izUY - xyY²  &amp; U² - y²Y²    &amp; -ixUY - yzY² \\
            -iyUY - xzY² &amp; ixUY - yzY²  &amp; U² - z²Y²
        \end{pmatrix}\]</p><p>where <span>$X = ωₚ²/ω²$</span>, <span>$Y = |ωₕ/ω|$</span>, <span>$Z = ν/ω$</span>, and <span>$U = 1 - iZ$</span>. The earth curvature correction subtracts <span>$2/Rₑ*(H - altitude)$</span> from the diagonal of <span>$M$</span> where <span>$H$</span> is <code>params.curvatureheight</code>.</p><p><strong>References</strong></p><p>[Pappert1967]: R. A. Pappert, E. E. Gossard, and I. J. Rothmuller, “A numerical     investigation of classical approximations used in VLF propagation,” Radio Science,     vol. 2, no. 4, pp. 387–400, Apr. 1967, doi: 10.1002/rds196724387.</p><p>[Ratcliffe1959]: J. A. Ratcliffe, &quot;The magneto-ionic theory &amp; its applications to the     ionosphere,&quot; Cambridge University Press, 1959.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/magnetoionic.jl#L6-L45">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.susceptibilityspline-Tuple{Any, Any, Any}" href="#LongwaveModePropagator.susceptibilityspline-Tuple{Any, Any, Any}"><code>LongwaveModePropagator.susceptibilityspline</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">susceptibilityspline(frequency, bfield, species; params=LMPParams())
susceptibilityspline(frequency, w::HomogeneousWaveguide; params=LMPParams())
susceptibilityspline(me::ModeEquation; params=LMPParams())</code></pre><p>Construct a cubic interpolating spline of <a href="#LongwaveModePropagator.susceptibility-NTuple{4, Any}"><code>susceptibility</code></a> and return the callable <code>Interpolations</code> type.</p><p><code>params.susceptibilitysplinestep</code> is the altitude step in meters used to construct the spline between <code>BOTTOMHEIGHT</code> and <code>params.topheight</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/magnetoionic.jl#L115-L125">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.modeconversion-Union{Tuple{H}, Tuple{LongwaveModePropagator.Wavefields{H}, LongwaveModePropagator.Wavefields{H}, LongwaveModePropagator.Wavefields{H}}} where H" href="#LongwaveModePropagator.modeconversion-Union{Tuple{H}, Tuple{LongwaveModePropagator.Wavefields{H}, LongwaveModePropagator.Wavefields{H}, LongwaveModePropagator.Wavefields{H}}} where H"><code>LongwaveModePropagator.modeconversion</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">modeconversion(previous_wavefields::Wavefields, wavefields::Wavefields,
    adjoint_wavefields::Wavefields; params=LMPParams())</code></pre><p>Compute the mode conversion matrix <code>a</code> from the modes associated with <code>previous_wavefields</code> to modes associated with <code>wavefields</code> and its <code>adjoint_wavefields</code>.</p><p>This is used in the approach known as full mode conversion [Pappert1972b].</p><p><strong>References</strong></p><p>[Pappert1972b]: R. A. Pappert and R. R. Smith, “Orthogonality of VLF height gains in the     earth ionosphere waveguide,” Radio Science, vol. 7, no. 2, pp. 275–278, 1972,     doi: 10.1029/RS007i002p00275.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/modeconversion.jl#L1-L15">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.dRdz" href="#LongwaveModePropagator.dRdz"><code>LongwaveModePropagator.dRdz</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">dRdz(R, modeequation, z, susceptibilityfcn=z-&gt;susceptibility(z, modeequation; params=LMPParams()))</code></pre><p>Compute the differential of the reflection matrix <code>R</code>, <span>$dR/dz$</span>, at height <code>z</code>. <code>susceptibilityfcn</code> is a function returning the ionosphere susceptibility at height <code>z</code>.  </p><p>Following the Budden formalism for the reflection of an (obliquely) incident plane wave from a horizontally stratified ionosphere [Budden1955a], the differential of the reflection matrix <code>R</code> with height <code>z</code> can be described by</p><p class="math-container">\[dR/dz = k/(2i)⋅(W₂₁ + W₂₂R - RW₁₁ - RW₁₂R)\]</p><p>Integrating <span>$dR/dz$</span> downwards through the ionosphere gives the reflection matrix <span>$R$</span> for the ionosphere as if it were a sharp boundary at the stopping level with free space below.</p><p><strong>References</strong></p><p>[Budden1955a]: K. G. Budden, “The numerical solution of differential equations governing     reflexion of long radio waves from the ionosphere,” Proc. R. Soc. Lond. A, vol. 227,     no. 1171, pp. 516–537, Feb. 1955.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/modefinder.jl#L220-L240">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.dRdθdz-Tuple{Any, Any, Any}" href="#LongwaveModePropagator.dRdθdz-Tuple{Any, Any, Any}"><code>LongwaveModePropagator.dRdθdz</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">dRdθdz(RdRdθ, p, z)</code></pre><p>Compute the differential <span>$dR/dθ/dz$</span> at height <code>z</code> returned as an <code>SMatrix{4,2}</code> with <span>$dR/dz$</span> in the first 2 rows and <span>$dR/dθ/dz$</span> in the bottom 2 rows.</p><p><code>p</code> is a tuple containing instances <code>(PhysicalModeEquation(), LMPParams())</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/modefinder.jl#L255-L262">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.defaultmesh-Tuple{Any}" href="#LongwaveModePropagator.defaultmesh-Tuple{Any}"><code>LongwaveModePropagator.defaultmesh</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">defaultmesh(frequency; rmin=deg2rad(30.0), imin=deg2rad(-10.0),
    Δr_coarse=deg2rad(0.5), Δr_fine=deg2rad(0.15),
    rtransition=deg2rad(75.0), itransition=deg2rad(-1.5))</code></pre><p>Generate vector of complex coordinates to be used by GRPF in the search for waveguide modes.</p><p><code>rmin</code> is the lower bound of the real axis and <code>imin</code> is the lower bound of the imaginary axis.</p><p>At frequencies above 12 kHz the mesh spacing in the upper right corner of the domain with real values above <code>rtransition</code> and imaginary values above <code>itransition</code> is <code>Δr_fine</code> and is <code>Δr_coarse</code> everywhere else.</p><p>At frequencies below 12 kHz the mesh spacing is always <code>Δr_coarse</code>.</p><p>The lower right diagonal of the lower right quadrant of the complex plane is excluded from the mesh.</p><p>See also: <a href="../public/#LongwaveModePropagator.findmodes"><code>findmodes</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/modefinder.jl#L569-L590">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.dmodalequation-NTuple{4, Any}" href="#LongwaveModePropagator.dmodalequation-NTuple{4, Any}"><code>LongwaveModePropagator.dmodalequation</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">dmodalequation(R, dR, Rg, dRg)</code></pre><p>Compute the derivative of the determinantal mode equation with respect to <span>$θ$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/modefinder.jl#L435-L439">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.dwmatrix-Tuple{EigenAngle, Any, Any}" href="#LongwaveModePropagator.dwmatrix-Tuple{EigenAngle, Any, Any}"><code>LongwaveModePropagator.dwmatrix</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">dwmatrix(ea::EigenAngle, T, dT)</code></pre><p>Compute the four submatrix elements of <span>$dW/dθ$</span> returned as the tuple <code>(dW₁₁, dW₂₁, dW₁₂, dW₂₂)</code> from the ionosphere with <code>T</code> matrix and its derivative with respect to <span>$θ$</span>, <code>dT</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/modefinder.jl#L180-L186">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.filterroots!" href="#LongwaveModePropagator.filterroots!"><code>LongwaveModePropagator.filterroots!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">filterroots!(roots, frequency, waveguide; atol=0.1)
filterroots!(roots, modeequation; atol=0.1)</code></pre><p>Remove elements from <code>roots</code> if they are not valid roots of the physical modal equation.</p><p>Although the default <code>atol</code> for this function is larger than for <code>isroot</code>(@ref), the modal equation is very sensitive to θ, and thus is much larger than 0.1 if θ is off from an eigenangle even slightly.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/modefinder.jl#L55-L64">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.fresnelreflection" href="#LongwaveModePropagator.fresnelreflection"><code>LongwaveModePropagator.fresnelreflection</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">fresnelreflection(ea::EigenAngle, ground::Ground, frequency::Frequency)
fresnelreflection(m::PhysicalModeEquation)</code></pre><p>Compute the Fresnel reflection coefficient matrix for the ground-freespace interface at the ground.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/modefinder.jl#L348-L354">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.fresnelreflection-Tuple{EigenAngle, Ground, Frequency, LongwaveModePropagator.Dθ}" href="#LongwaveModePropagator.fresnelreflection-Tuple{EigenAngle, Ground, Frequency, LongwaveModePropagator.Dθ}"><code>LongwaveModePropagator.fresnelreflection</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">fresnelreflection(ea::EigenAngle, ground::Ground, frequency::Frequency, ::Dθ)
fresnelreflection(m::PhysicalModeEquation, ::Dθ)</code></pre><p>Compute the Fresnel reflection coefficient matrix for the ground as well as its derivative with respect to <span>$θ$</span> returned as the tuple <code>(Rg, dRg)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/modefinder.jl#L377-L383">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.integratedreflection-Tuple{PhysicalModeEquation, LongwaveModePropagator.Dθ}" href="#LongwaveModePropagator.integratedreflection-Tuple{PhysicalModeEquation, LongwaveModePropagator.Dθ}"><code>LongwaveModePropagator.integratedreflection</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">integratedreflection(modeequation::PhysicalModeEquation, ::Dθ; params=LMPParams())</code></pre><p>Compute <span>$R$</span> and <span>$dR/dθ$</span> as an <code>SMatrix{4,2}</code> with <span>$R$</span> in rows (1, 2) and <span>$dR/dθ$</span> in rows (3, 4).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/modefinder.jl#L317-L322">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.integratedreflection-Tuple{PhysicalModeEquation}" href="#LongwaveModePropagator.integratedreflection-Tuple{PhysicalModeEquation}"><code>LongwaveModePropagator.integratedreflection</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">integratedreflection(modeequation::PhysicalModeEquation;
    params=LMPParams(), susceptibilityfcn=z-&gt;susceptibility(z, modeequation; params=params))</code></pre><p>Integrate <span>$dR/dz$</span> downward through the ionosphere described by <code>modeequation</code> from <code>params.topheight</code>, returning the ionosphere reflection coefficient <code>R</code> at the ground. <code>susceptibilityfcn</code> is a function returning the ionosphere susceptibility tensor as a function of altitude <code>z</code> in meters.</p><p><code>params.integrationparams</code> are passed to <code>DifferentialEquations.jl</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/modefinder.jl#L285-L295">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.isroot-Tuple{Any}" href="#LongwaveModePropagator.isroot-Tuple{Any}"><code>LongwaveModePropagator.isroot</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">isroot(x; atol=1e-2)</code></pre><p>Return <code>true</code> if <code>x</code> is approximately equal to 0 with the absolute tolerance <code>atol</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/modefinder.jl#L48-L52">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.modalequation-Tuple{Any, Any}" href="#LongwaveModePropagator.modalequation-Tuple{Any, Any}"><code>LongwaveModePropagator.modalequation</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">modalequation(R, Rg)</code></pre><p>Compute the determinental mode equation <span>$det(Rg R - I)$</span> given reflection coefficients <code>R</code> and <code>Rg</code>.</p><p>A propagating waveguide mode requires that a wave, having reflected from the ionosphere and then the ground, must be identical with the original upgoing wave. This criteria is met at roots of the mode equation [Budden1962].</p><p><strong>References</strong></p><p>[Budden1962]: K. G. Budden and N. F. Mott, “The influence of the earth’s magnetic field on     radio propagation by wave-guide modes,” Proceedings of the Royal Society of London.     Series A. Mathematical and Physical Sciences, vol. 265, no. 1323, pp. 538–553,     Feb. 1962.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/modefinder.jl#L414-L430">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.solvedmodalequation-Tuple{Any, PhysicalModeEquation}" href="#LongwaveModePropagator.solvedmodalequation-Tuple{Any, PhysicalModeEquation}"><code>LongwaveModePropagator.solvedmodalequation</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">solvedmodalequation(θ, modeequation::PhysicalModeEquation; params=LMPParams())</code></pre><p>Set <code>θ</code> for <code>modeequation</code> and then solve the derivative of the mode equation with respect to <code>θ</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/modefinder.jl#L498-L503">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.solvedmodalequation-Tuple{PhysicalModeEquation}" href="#LongwaveModePropagator.solvedmodalequation-Tuple{PhysicalModeEquation}"><code>LongwaveModePropagator.solvedmodalequation</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">solvedmodalequation(modeequation::PhysicalModeEquation; params=LMPParams())</code></pre><p>Compute the derivative of the modal equation with respect to <span>$θ$</span> returned as the tuple <code>(dF, R, Rg)</code> for the ionosphere and ground reflection coefficients.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/modefinder.jl#L481-L486">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.solvemodalequation-Tuple{Any, PhysicalModeEquation}" href="#LongwaveModePropagator.solvemodalequation-Tuple{Any, PhysicalModeEquation}"><code>LongwaveModePropagator.solvemodalequation</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">solvemodalequation(θ, modeequation::PhysicalModeEquation;
    params=LMPParams(), susceptibilityfcn=z-&gt;susceptibility(z, modeequation; params=params))</code></pre><p>Set <code>θ</code> for <code>modeequation</code> and then solve the modal equation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/modefinder.jl#L467-L472">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.solvemodalequation-Tuple{PhysicalModeEquation}" href="#LongwaveModePropagator.solvemodalequation-Tuple{PhysicalModeEquation}"><code>LongwaveModePropagator.solvemodalequation</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">solvemodalequation(modeequation::PhysicalModeEquation;
    params=LMPParams(), susceptibilityfcn=z-&gt;susceptibility(z, modeequation; params=params))</code></pre><p>Compute the ionosphere and ground reflection coefficients and return the value of the determinental modal equation associated with <code>modeequation</code>. <code>susceptibilityfcn</code> is a function that returns the ionosphere susceptibility as a function of altitude <code>z</code> in meters.</p><p>See also: <a href="#LongwaveModePropagator.solvedmodalequation-Tuple{Any, PhysicalModeEquation}"><code>solvedmodalequation</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/modefinder.jl#L447-L456">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.trianglemesh-Tuple{Any, Any, Any}" href="#LongwaveModePropagator.trianglemesh-Tuple{Any, Any, Any}"><code>LongwaveModePropagator.trianglemesh</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">trianglemesh(zbl, ztr, Δr)</code></pre><p>Generate initial mesh node coordinates for a right triangle domain from complex coordinate <code>zbl</code> in the bottom left and <code>ztr</code> in the top right with initial mesh step <code>Δr</code>.</p><p><code>zbl</code> and <code>ztr</code> are located on the complex plane at the locations marked in the diagram below:</p><pre><code class="language-none">       im
       |
-re ---|------ ztr
       |     /
       |    /
       |   /
       |  /
       zbl</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/modefinder.jl#L620-L639">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.wmatrix-Tuple{EigenAngle, Any}" href="#LongwaveModePropagator.wmatrix-Tuple{EigenAngle, Any}"><code>LongwaveModePropagator.wmatrix</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">wmatrix(ea::EigenAngle, T)</code></pre><p>Compute the four submatrix elements of <code>W</code> used in the equation <span>$dR/dz$</span> from the ionosphere with <code>T</code> matrix returned as a tuple <code>(W₁₁, W₂₁, W₁₂, W₂₂)</code>.</p><p>Following Budden&#39;s formalism for the reflection matrix of a plane wave obliquely incident on the ionosphere [Budden1955a], the wave below the ionosphere can be resolved into upgoing and downgoing waves of elliptical polarization, each of whose components are themselves resolved into a component with the electric field in the plane of propagation and a component perpendicular to the plane of propagation. The total field can be written in matrix form as <span>$e = Lf$</span> where <span>$L$</span> is a 4×4 matrix that simply selects and specifies the incident angle of the components and <span>$f$</span> is a column matrix of the complex amplitudes of the component waves. By inversion, <span>$f = L⁻¹e$</span> and its derivative with respect to height <span>$z$</span> is <span>$f′ = -iL⁻¹TLf = -½iWf$</span>. Then <span>$W = 2L⁻¹TL$</span> describes the change in amplitude of the upgoing and downgoing component waves.</p><p><span>$W$</span> is also known as <span>$S$</span> in many texts.</p><p><strong>References</strong></p><p>[Budden1955a]: K. G. Budden, “The numerical solution of differential equations governing     reflexion of long radio waves from the ionosphere,” Proc. R. Soc. Lond. A, vol. 227,     no. 1171, pp. 516–537, Feb. 1955.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/modefinder.jl#L86-L110">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.ExcitationFactor" href="#LongwaveModePropagator.ExcitationFactor"><code>LongwaveModePropagator.ExcitationFactor</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">ExcitationFactor{T,T2}</code></pre><p>Constants used in calculating excitation factors and height gains.</p><p><strong>Fields</strong></p><ul><li><code>F₁::T</code>: height gain constant. See [Pappert1976].</li><li><code>F₂::T</code></li><li><code>F₃::T</code></li><li><code>F₄::T</code></li><li><code>h₁0::T</code>: first modified Hankel function of order 1/3 at the ground.</li><li><code>h₂0::T</code>: second modified Hankel function of order 1/3 at the ground.</li><li><code>EyHy::T</code>: polarization ratio <span>$Ey/Hy$</span>, derived from reflection coefficients (or <span>$T$</span>s).</li><li><code>Rg::T2</code>: ground reflection coefficient matrix.</li></ul><p><strong>References</strong></p><p>[Pappert1976]: R. A. Pappert and L. R. Shockey, “Simplified VLF/LF mode conversion program     with allowance for elevated, arbitrarily oriented electric dipole antennas,” Naval     Electronics Laboratory Center, San Diego, CA, Interim Report 771, Oct. 1976. [Online].     Available: http://archive.org/details/DTIC_ADA033412.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/modesum.jl#L5-L27">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.Efield-Tuple{Any, HomogeneousWaveguide, LongwaveModePropagator.Emitter, LongwaveModePropagator.AbstractSampler}" href="#LongwaveModePropagator.Efield-Tuple{Any, HomogeneousWaveguide, LongwaveModePropagator.Emitter, LongwaveModePropagator.AbstractSampler}"><code>LongwaveModePropagator.Efield</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">Efield(modes, waveguide::HomogeneousWaveguide, tx::Emitter, rx::AbstractSampler;
       params=LMPParams())</code></pre><p>Compute the complex electric field by summing <code>modes</code> in <code>waveguide</code> for emitter <code>tx</code> at sampler <code>rx</code>.</p><p><strong>References</strong></p><p>[Morfitt1980]: D. G. Morfitt, “‘Simplified’ VLF/LF mode conversion computer programs:     GRNDMC and ARBNMC,” Naval Ocean Systems Center, San Diego, CA, NOSC/TR-514, Jan. 1980.     [Online]. Available: http://www.dtic.mil/docs/citations/ADA082695.</p><p>[Pappert1983]: R. A. Pappert, L. R. Hitney, and J. A. Ferguson, “ELF/VLF (Extremely Low     Frequency/Very Low Frequency) long path pulse program for antennas of arbitrary     elevation and orientation,” Naval Ocean Systems Center, San Diego, CA, NOSC/TR-891,     Aug. 1983. [Online]. Available: http://www.dtic.mil/docs/citations/ADA133876.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/modesum.jl#L372-L389">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.Efield-Tuple{SegmentedWaveguide, Any, Any, LongwaveModePropagator.Emitter, LongwaveModePropagator.AbstractSampler}" href="#LongwaveModePropagator.Efield-Tuple{SegmentedWaveguide, Any, Any, LongwaveModePropagator.Emitter, LongwaveModePropagator.AbstractSampler}"><code>LongwaveModePropagator.Efield</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">Efield(waveguide::SegmentedWaveguide, wavefields_vec, adjwavefields_vec, tx::Emitter,
       rx::AbstractSampler; params=LMPParams())</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/modesum.jl#L471-L474">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.excitationfactor-Tuple{Any, Any, Any, LongwaveModePropagator.ExcitationFactor}" href="#LongwaveModePropagator.excitationfactor-Tuple{Any, Any, Any, LongwaveModePropagator.ExcitationFactor}"><code>LongwaveModePropagator.excitationfactor</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">excitationfactor(ea, dFdθ, R, Rg, efconstants::ExcitationFactor; params=LMPParams())</code></pre><p>Compute excitation factors for the <span>$Hy$</span> field at the emitter returned as the tuple <code>(λv, λb, λe)</code> for vertical, broadside, and end-on dipoles. <code>dFdθ</code> is the derivative of the modal equation with respect to <span>$θ$</span>.</p><p>The excitation factor describes how efficiently the field component can be excited in the waveguide.</p><p>This function most closely follows the approach taken in [Pappert1983], which makes use of <span>$T$</span> (different from <code>TMatrix</code>) rather than <span>$τ$</span>. From the total <span>$Hy$</span> excitation factor (the sum product of the <code>λ</code>s with the antenna orientation terms), the excitation factor for electric fields can be found as:</p><ul><li><span>$λz = -S₀λ$</span></li><li><span>$λx = EyHy⋅λ$</span></li><li><span>$λy = -λ$</span></li></ul><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>This function assumes that reflection coefficients <code>R</code> and <code>Rg</code> are referenced to <span>$d = z = 0$</span>.</p></div></div><p><strong>References</strong></p><p>[Morfitt1980]: D. G. Morfitt, “‘Simplified’ VLF/LF mode conversion computer programs:     GRNDMC and ARBNMC,” Naval Ocean Systems Center, San Diego, CA, NOSC/TR-514, Jan. 1980.     [Online]. Available: http://www.dtic.mil/docs/citations/ADA082695.</p><p>[Pappert1983]: R. A. Pappert, L. R. Hitney, and J. A. Ferguson, “ELF/VLF (Extremely Low     Frequency/Very Low Frequency) long path pulse program for antennas of arbitrary     elevation and orientation,” Naval Ocean Systems Center, San Diego, CA, NOSC/TR-891,     Aug. 1983. [Online]. Available: http://www.dtic.mil/docs/citations/ADA133876.</p><p>[Pappert1986]: R. A. Pappert and J. A. Ferguson, “VLF/LF mode conversion model calculations     for air to air transmissions in the earth-ionosphere waveguide,” Radio Sci., vol. 21,     no. 4, pp. 551–558, Jul. 1986, doi: 10.1029/RS021i004p00551.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/modesum.jl#L114-L152">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.excitationfactorconstants-NTuple{5, Any}" href="#LongwaveModePropagator.excitationfactorconstants-NTuple{5, Any}"><code>LongwaveModePropagator.excitationfactorconstants</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">excitationfactorconstants(ea₀, R, Rg, frequency, ground; params=LMPParams())</code></pre><p>Return an <code>ExcitationFactor</code> struct used in calculating height-gain functions and excitation factors where eigenangle <code>ea₀</code> is referenced to the ground.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>This function assumes that reflection coefficients <code>R</code> and <code>Rg</code> are referenced to <span>$d = z = 0$</span>.</p></div></div><p><strong>References</strong></p><p>[Pappert1976]: R. A. Pappert and L. R. Shockey, “Simplified VLF/LF mode conversion program     with allowance for elevated, arbitrarily oriented electric dipole antennas,” Naval     Electronics Laboratory Center, San Diego, CA, Interim Report 771, Oct. 1976. [Online].     Available: http://archive.org/details/DTIC_ADA033412.</p><p>[Ferguson1980]: J. A. Ferguson and F. P. Snyder, “Approximate VLF/LF waveguide mode     conversion model: Computer applications: FASTMC and BUMP,” Naval Ocean Systems Center,     San Diego, CA, NOSC-TD-400, Nov. 1980. [Online].     Available: http://www.dtic.mil/docs/citations/ADA096240.</p><p>[Morfitt1980]: D. G. Morfitt, “‘Simplified’ VLF/LF mode conversion computer programs:     GRNDMC and ARBNMC,” Naval Ocean Systems Center, San Diego, CA, NOSC/TR-514, Jan. 1980.     [Online]. Available: http://www.dtic.mil/docs/citations/ADA082695.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/modesum.jl#L39-L65">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.heightgains-Tuple{Any, Any, Any, LongwaveModePropagator.ExcitationFactor}" href="#LongwaveModePropagator.heightgains-Tuple{Any, Any, Any, LongwaveModePropagator.ExcitationFactor}"><code>LongwaveModePropagator.heightgains</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">heightgains(z, ea₀, frequency, efconstants::ExcitationFactor; params=LMPParams())</code></pre><p>Compute height gain functions at height <code>z</code> returned as the tuple <code>(fz, fy, fx)</code> where eigenangle <code>ea₀</code> is referenced to the ground.</p><ul><li><code>fz</code> is the height gain for the vertical electric field component <span>$Ez$</span>.</li><li><code>fy</code> is the height gain for the transverse electric field component <span>$Ey$</span>.</li><li><code>fx</code> is the height gain for the horizontal electric field component <span>$Ex$</span>.</li></ul><p>[Pappert1983]</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>This function assumes that reflection coefficients are referenced to <span>$d = z = 0$</span>.</p></div></div><p>See also: <a href="#LongwaveModePropagator.excitationfactorconstants-NTuple{5, Any}"><code>excitationfactorconstants</code></a></p><p><strong>References</strong></p><p>[Pappert1983]: R. A. Pappert, L. R. Hitney, and J. A. Ferguson, “ELF/VLF (Extremely Low     Frequency/Very Low Frequency) long path pulse program for antennas of arbitrary     elevation and orientation,” Naval Ocean Systems Center, San Diego, CA, NOSC/TR-891,     Aug. 1983. [Online]. Available: http://www.dtic.mil/docs/citations/ADA133876.</p><p>[Pappert1986]: R. A. Pappert and J. A. Ferguson, “VLF/LF mode conversion model calculations     for air to air transmissions in the earth-ionosphere waveguide,” Radio Sci., vol. 21,     no. 4, pp. 551–558, Jul. 1986, doi: 10.1029/RS021i004p00551.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/modesum.jl#L185-L212">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.modeterms-Tuple{Any, LongwaveModePropagator.Emitter, LongwaveModePropagator.AbstractSampler}" href="#LongwaveModePropagator.modeterms-Tuple{Any, LongwaveModePropagator.Emitter, LongwaveModePropagator.AbstractSampler}"><code>LongwaveModePropagator.modeterms</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">modeterms(modeequation, tx::Emitter, rx::AbstractSampler; params=LMPParams())</code></pre><p>Compute <code>tx</code> and <code>rx</code> height-gain and excitation factor products and <code>ExcitationFactor</code> constants returned as the tuple <code>(txterm, rxterm)</code>.</p><p>The returned <code>txterm</code> is:</p><p class="math-container">\[λ_v \cos(γ) f_z(zₜ) + λ_b \sin(γ)\sin(ϕ) f_y(zₜ) + λ_e \sin(γ)\cos(ϕ) f_z(zₜ)\]</p><p>and <code>rxterm</code> is the height-gain function <span>$f(zᵣ)$</span> appropriate for <code>rx.fieldcomponent</code>:</p><table><tr><th style="text-align: center"><code>fieldcomponent</code></th><th style="text-align: center"><span>$f(zᵣ)$</span></th></tr><tr><td style="text-align: center"><span>$z$</span></td><td style="text-align: center"><span>$-S₀⋅f_z$</span></td></tr><tr><td style="text-align: center"><span>$y$</span></td><td style="text-align: center"><span>$EyHy⋅f_y$</span></td></tr><tr><td style="text-align: center"><span>$x$</span></td><td style="text-align: center"><span>$-f_x$</span></td></tr></table><p><strong>References</strong></p><p>[Pappert1976]: R. A. Pappert and L. R. Shockey, “Simplified VLF/LF mode conversion program     with allowance for elevated, arbitrarily oriented electric dipole antennas,” Naval     Electronics Laboratory Center, San Diego, CA, Interim Report 771, Oct. 1976. [Online].     Available: http://archive.org/details/DTIC_ADA033412.</p><p>[Morfitt1980]: D. G. Morfitt, “‘Simplified’ VLF/LF mode conversion computer programs:     GRNDMC and ARBNMC,” Naval Ocean Systems Center, San Diego, CA, NOSC/TR-514, Jan. 1980.     [Online]. Available: http://www.dtic.mil/docs/citations/ADA082695.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/modesum.jl#L252-L280">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.AbstractSampler" href="#LongwaveModePropagator.AbstractSampler"><code>LongwaveModePropagator.AbstractSampler</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">AbstractSampler</code></pre><p>Abstract supertype for sampling fields in the waveguide.</p><p>Subtypes of AbstractSampler have a position in the guide and a <code>Fields.Field</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/Samplers.jl#L25-L31">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.TMatrix" href="#LongwaveModePropagator.TMatrix"><code>LongwaveModePropagator.TMatrix</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">TMatrix &lt;: SMatrix{4, 4, T}</code></pre><p>A custom <code>SMatrix</code> subtype that represents the <code>T</code> matrix from [Clemmow1954] that is semi-sparse. The form of the matrix is:</p><pre><code class="language-none">┌                ┐
| T₁₁ T₁₂ 0  T₁₄ |
| 0   0   1  0   |
| T₃₁ T₃₂ 0  T₃₄ |
| T₄₁ T₄₂ 0  T₄₄ |
└                ┘</code></pre><p><code>TMatrix</code> implements efficient matrix-vector multiplication and other math based on its special form.</p><p>See also: <a href="#LongwaveModePropagator.tmatrix-Tuple{EigenAngle, Any}"><code>tmatrix</code></a></p><p><strong>References</strong></p><p>[Clemmow1954]: P. C. Clemmow and J. Heading, “Coupled forms of the differential equations     governing radio propagation in the ionosphere,” Mathematical Proceedings of the     Cambridge Philosophical Society, vol. 50, no. 2, pp. 319–333, Apr. 1954.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/TMatrix.jl#L1-L26">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.dtmatrix-Tuple{EigenAngle, Any}" href="#LongwaveModePropagator.dtmatrix-Tuple{EigenAngle, Any}"><code>LongwaveModePropagator.dtmatrix</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">dtmatrix(ea::EigenAngle, M)</code></pre><p>Compute a dense <code>SMatrix</code> with the derivative of <code>T</code> with respect to <code>θ</code>.</p><p>See also: <a href="#LongwaveModePropagator.tmatrix-Tuple{EigenAngle, Any}"><code>tmatrix</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/TMatrix.jl#L305-L311">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.tmatrix-Tuple{EigenAngle, Any}" href="#LongwaveModePropagator.tmatrix-Tuple{EigenAngle, Any}"><code>LongwaveModePropagator.tmatrix</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">tmatrix(ea::EigenAngle, M)</code></pre><p>Compute the matrix <code>T</code> as a <code>TMatrix</code> for the differential equations of a wave propagating at angle <code>ea</code> in an ionosphere with susceptibility <code>M</code>.</p><p>Clemmow and Heading derived the <code>T</code> matrix from Maxwell&#39;s equations for an electromagnetic wave in the anisotropic, collisional cold plasma of the ionosphere in a coordinate frame where <span>$z$</span> is upward, propagation is directed obliquely in the <span>$x$</span>-<span>$z$</span> plane and invariance is assumed in <span>$y$</span>. For the four characteristic wave components <span>$e = (Ex, -Ey, Z₀Hx, Z₀Hy)ᵀ$</span>, the differential equations are <span>$de/dz = -ikTe$</span>.</p><p>See also: <a href="#LongwaveModePropagator.susceptibility-NTuple{4, Any}"><code>susceptibility</code></a>, <a href="#LongwaveModePropagator.dtmatrix-Tuple{EigenAngle, Any}"><code>dtmatrix</code></a></p><p><strong>References</strong></p><p>[Budden1955a]: K. G. Budden, “The numerical solution of differential equations governing     reflexion of long radio waves from the ionosphere,” Proc. R. Soc. Lond. A, vol. 227,     no. 1171, pp. 516–537, Feb. 1955.</p><p>[Clemmow1954]: P. C. Clemmow and J. Heading, “Coupled forms of the differential equations     governing radio propagation in the ionosphere,” Mathematical Proceedings of the     Cambridge Philosophical Society, vol. 50, no. 2, pp. 319–333, Apr. 1954.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/TMatrix.jl#L249-L272">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.amplitude-Tuple{Any}" href="#LongwaveModePropagator.amplitude-Tuple{Any}"><code>LongwaveModePropagator.amplitude</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">amplitude(e)</code></pre><p>Compute field amplitude in dB.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/utils.jl#L5-L9">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.amplitudephase-Tuple{Any}" href="#LongwaveModePropagator.amplitudephase-Tuple{Any}"><code>LongwaveModePropagator.amplitudephase</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">amplitudephase(e)</code></pre><p>Compute field amplitude in dB and phase in radians and return as (<code>amplitude</code>, <code>phase</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/utils.jl#L12-L16">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.pow23" href="#LongwaveModePropagator.pow23"><code>LongwaveModePropagator.pow23</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">pow23(x)</code></pre><p>Efficiently compute <span>$x^(2/3)$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/utils.jl#L51-L55">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.unwrap!" href="#LongwaveModePropagator.unwrap!"><code>LongwaveModePropagator.unwrap!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">unwrap!(x)</code></pre><p>Unwrap a phase vector <code>x</code> in radians in-place.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/utils.jl#L34-L38">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.ScaleRecord" href="#LongwaveModePropagator.ScaleRecord"><code>LongwaveModePropagator.ScaleRecord</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">ScaleRecord</code></pre><p>Struct for saving wavefield scaling information used in a callback during Pitteway integration of wavefields [Pitteway1965].</p><p><strong>Fields</strong></p><ul><li><code>z::Float64</code>: current height in meters.</li><li><code>e::SMatrix{4,2,Complex{Float64},8}</code>: wavefield matrix.</li><li><code>ortho_scalar::Complex{Float64}</code>: scalar for Gram-Schmidt orthogonalization.</li><li><code>e1_scalar::Float64</code>: scalar for wavefield vector 1.</li><li><code>e2_scalar::Float64</code>: scalar for wavefield vector 2.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/Wavefields.jl#L119-L132">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.WavefieldIntegrationParams" href="#LongwaveModePropagator.WavefieldIntegrationParams"><code>LongwaveModePropagator.WavefieldIntegrationParams</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">WavefieldIntegrationParams{S,T,T2,H}</code></pre><p>Parameters passed to Pitteway integration of wavefields [Pitteway1965].</p><p><strong>Fields</strong></p><ul><li><code>z::Float64</code>: height in meters.</li><li><code>bottomz::Float64</code>: bottom height of integration in meters.</li><li><code>ortho_scalar::Complex{Float64}</code>: scalar for Gram-Schmidt orthogonalization.</li><li><code>e1_scalar::Float64</code>: scalar for wavefield vector 1.</li><li><code>e2_scalar::Float64</code>: scalar for wavefield vector 2.</li><li><code>ea::EigenAngle</code>: wavefield eigenangle.</li><li><code>frequency::Frequency</code>: electromagentic wave frequency in Hz.</li><li><code>bfield::BField</code>: Earth&#39;s magnetic field in Tesla.</li><li><code>species::S</code>: species in the ionosphere.</li><li><code>params::LMPParams{T,T2,H}</code>: module-wide parameters.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/Wavefields.jl#L69-L86">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.WavefieldIntegrationParams-Union{Tuple{H}, Tuple{T2}, Tuple{T}, Tuple{S}, Tuple{Any, Any, Any, Any, S, LMPParams{T, T2, H}}} where {S, T, T2, H}" href="#LongwaveModePropagator.WavefieldIntegrationParams-Union{Tuple{H}, Tuple{T2}, Tuple{T}, Tuple{S}, Tuple{Any, Any, Any, Any, S, LMPParams{T, T2, H}}} where {S, T, T2, H}"><code>LongwaveModePropagator.WavefieldIntegrationParams</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">WavefieldIntegrationParams(topheight, ea, frequency, bfield, species, params)</code></pre><p>Initialize a <code>WavefieldIntegrationParams</code> for downward Pitteway scaled integration [Pitteway1965].</p><p>Automatically set values are:</p><ul><li><code>bottomz = BOTTOMHEIGHT</code></li><li><code>ortho_scalar = zero(ComplexF64)</code></li><li><code>e1_scalar = one(Float64)</code></li><li><code>e2_scalar = one(Float64)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/Wavefields.jl#L100-L112">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.Wavefields" href="#LongwaveModePropagator.Wavefields"><code>LongwaveModePropagator.Wavefields</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">Wavefields{H&lt;:AbstractRange}</code></pre><p>Struct containing wavefield components for each mode of <code>eas</code> at <code>heights</code>.</p><p>The six electromagnetic field components are stored in the <code>v</code> field of the struct and accessed as a <code>Matrix</code> of <code>SVector{6,ComplexF64}</code> corresponding to <code>[height, mode]</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/Wavefields.jl#L9-L16">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.Wavefields-Tuple{Any, Vector{EigenAngle}}" href="#LongwaveModePropagator.Wavefields-Tuple{Any, Vector{EigenAngle}}"><code>LongwaveModePropagator.Wavefields</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">Wavefields(heights, eas::Vector{EigenAngle})</code></pre><p>A constructor for initializing <code>Wavefields</code> with an appropriately sized <code>undef</code> Matrix given eigenangles <code>eas</code> and <code>heights</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/Wavefields.jl#L23-L28">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.:==-Tuple{LongwaveModePropagator.Wavefields, LongwaveModePropagator.Wavefields}" href="#Base.:==-Tuple{LongwaveModePropagator.Wavefields, LongwaveModePropagator.Wavefields}"><code>Base.:==</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">==(A::Wavefields, B::Wavefields)</code></pre><p>Check for equality <code>==</code> between <code>A.v</code> and <code>B.v</code>, <code>heights</code>, and <code>eas</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/Wavefields.jl#L43-L47">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.boundaryscalars" href="#LongwaveModePropagator.boundaryscalars"><code>LongwaveModePropagator.boundaryscalars</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">boundaryscalars(R, Rg, e1, e2, isotropic::Bool=false)
boundaryscalars(R, Rg, e, isotropic::Bool=false)</code></pre><p>Compute coefficients <code>(b1, b2)</code> required to sum the two wavefields vectors <code>e1</code> and <code>e2</code> or both columns of <code>e</code> for the total wavefield at the ground as <span>$e = b1*e1 + b2*e2$</span>.</p><p>The <code>b1</code> and <code>b2</code> that satisfy the waveguide boundary conditions are only valid for true eigenangles of the waveguide.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>This function assumes that the reflection coefficients <code>R</code> and <code>Rg</code> and the wavefield vectors <code>e1</code>, <code>e2</code> are at the ground.</p><p>These boundary conditions</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/Wavefields.jl#L400-L416">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.calculate_wavefields!-NTuple{5, Any}" href="#LongwaveModePropagator.calculate_wavefields!-NTuple{5, Any}"><code>LongwaveModePropagator.calculate_wavefields!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">calculate_wavefields!(wavefields, adjoint_wavefields, frequency, waveguide,
    adjoint_waveguide; params=LMPParams())</code></pre><p>Compute fields of <code>wavefields</code> in-place scaled to satisfy the <code>waveguide</code> boundary conditions.</p><p>This function implements the method of integrating wavefields suggested by [Pitteway1965].</p><p><strong>References</strong></p><p>[Pitteway1965]: M. L. V. Pitteway, “The numerical calculation of wave-fields, reflexion     coefficients and polarizations for long radio waves in the lower ionosphere. I.,” Phil.     Trans. R. Soc. Lond. A, vol. 257, no. 1079, pp. 219–241, Mar. 1965,     doi: 10.1098/rsta.1965.0004.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/Wavefields.jl#L523-L539">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.dedz-Tuple{Any, Any, Any}" href="#LongwaveModePropagator.dedz-Tuple{Any, Any, Any}"><code>LongwaveModePropagator.dedz</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">dedz(e, p, z)</code></pre><p>Compute derivative of field components vector <code>e</code> at height <code>z</code>.</p><p>The parameter <code>p</code> should be a <code>WavefieldIntegrationParams</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/Wavefields.jl#L148-L154">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.dedz-Tuple{Any, Any, LongwaveModePropagator.TMatrix}" href="#LongwaveModePropagator.dedz-Tuple{Any, Any, LongwaveModePropagator.TMatrix}"><code>LongwaveModePropagator.dedz</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">dedz(e, k, T::Tmatrix)</code></pre><p>Compute <span>$de/dz = -ikTe$</span> where <span>$e = (Ex, -Ey, Z₀Hx, Z₀Hy)ᵀ$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/Wavefields.jl#L141-L145">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.fieldstrengths!-Tuple{Any, Any, EigenAngle, Frequency, BField, Any, Ground}" href="#LongwaveModePropagator.fieldstrengths!-Tuple{Any, Any, EigenAngle, Frequency, BField, Any, Ground}"><code>LongwaveModePropagator.fieldstrengths!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">fieldstrengths!(EH, zs, me::ModeEquation; params=LMPParams())
fieldstrengths!(EH, zs, ea::EigenAngle, frequency::Frequency, bfield::BField,
    species, ground::Ground; params=LMPParams())</code></pre><p>Compute <span>$(Ex, Ey, Ez, Hx, Hy, Hz)ᵀ$</span> wavefields vectors as elements of <code>EH</code> by fullwave integration at each height in <code>zs</code>.</p><p>The wavefields are scaled to satisfy the waveguide boundary conditions, which is only valid at solutions of the mode equation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/Wavefields.jl#L460-L470">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.fieldstrengths-Tuple{Any, LongwaveModePropagator.ModeEquation}" href="#LongwaveModePropagator.fieldstrengths-Tuple{Any, LongwaveModePropagator.ModeEquation}"><code>LongwaveModePropagator.fieldstrengths</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">fieldstrengths(zs, me::ModeEquation; params=LMPParams())</code></pre><p>Preallocate vector of wavefields <code>EH</code>, then call <a href="#LongwaveModePropagator.fieldstrengths!-Tuple{Any, Any, EigenAngle, Frequency, BField, Any, Ground}"><code>fieldstrengths!</code></a> and return <code>EH</code>.</p><p>Each element of <code>EH</code> is an <code>SVector</code> of <span>$ex, ey, ez, hx, hy, hz$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/Wavefields.jl#L510-L516">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.integratewavefields-Tuple{Any, EigenAngle, Frequency, BField, Any}" href="#LongwaveModePropagator.integratewavefields-Tuple{Any, EigenAngle, Frequency, BField, Any}"><code>LongwaveModePropagator.integratewavefields</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">integratewavefields(zs, ea::EigenAngle, frequency::Frequency, bfield::BField,
    species; params=LMPParams())</code></pre><p>Compute wavefields vectors <code>e</code> at <code>zs</code> by downward integration over heights <code>zs</code>.</p><p><code>params.integrationparams</code> is not used by this function.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/Wavefields.jl#L346-L353">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.savevalues-Tuple{Any, Any, Any}" href="#LongwaveModePropagator.savevalues-Tuple{Any, Any, Any}"><code>LongwaveModePropagator.savevalues</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">savevalues(u, t, integrator)</code></pre><p>Return a <code>ScaleRecord</code> from <code>u</code>, <code>t</code>, and <code>integrator</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/Wavefields.jl#L335-L339">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.scale!-Tuple{Any}" href="#LongwaveModePropagator.scale!-Tuple{Any}"><code>LongwaveModePropagator.scale!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">scale!(integrator)</code></pre><p>Apply wavefield scaling with <a href="#LongwaveModePropagator.scalewavefields"><code>scalewavefields</code></a> to the integrator.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/Wavefields.jl#L175-L179">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.scalewavefields" href="#LongwaveModePropagator.scalewavefields"><code>LongwaveModePropagator.scalewavefields</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">scalewavefields(e1, e2)
scalewavefields(e::SMatrix{4,2})</code></pre><p>Orthonormalize the vectors <code>e1</code> and <code>e2</code> or the columns of <code>e</code>, and also return the scaling terms <code>a</code>, <code>e1_scale_val</code>, and <code>e2_scale_val</code> applied to the original vectors.</p><p>This first applies Gram-Schmidt orthogonalization and then scales the vectors so they each have length 1, i.e. <code>norm(e1) == norm(e2) == 1</code>. This is the technique suggested by [Pitteway1965] to counter numerical swamping during integration of wavefields.</p><p><strong>References</strong></p><p>[Pitteway1965]: M. L. V. Pitteway, “The numerical calculation of wave-fields, reflexion     coefficients and polarizations for long radio waves in the lower ionosphere. I.,” Phil.     Trans. R. Soc. Lond. A, vol. 257, no. 1079, pp. 219–241, Mar. 1965,     doi: 10.1098/rsta.1965.0004.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/Wavefields.jl#L207-L224">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.scalingcondition-Tuple{Any, Any, Any}" href="#LongwaveModePropagator.scalingcondition-Tuple{Any, Any, Any}"><code>LongwaveModePropagator.scalingcondition</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">scalingcondition(e, z, int)</code></pre><p>Return <code>true</code> if wavefields should be scaled, otherwise <code>false</code> for wavefields <code>e</code> at height <code>z</code> and integrator <code>int</code>.</p><p>Wavefields should be scaled if any component of <code>real(e)</code> or <code>imag(e)</code> are <code>&gt;= 1</code>. In addition, force scaling at <code>z &lt;= bottomz</code> to ensure initial upgoing wave is unit amplitude.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/Wavefields.jl#L164-L172">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.unscalewavefields!-Tuple{Any, DiffEqCallbacks.SavedValues}" href="#LongwaveModePropagator.unscalewavefields!-Tuple{Any, DiffEqCallbacks.SavedValues}"><code>LongwaveModePropagator.unscalewavefields!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">unscalewavefields!(e, saved_values::SavedValues)</code></pre><p>Unscale the integrated wavefields, a vector of fields at each integration step <code>e</code>, in place.</p><p>See also: <a href="#LongwaveModePropagator.unscalewavefields-Tuple{DiffEqCallbacks.SavedValues}"><code>unscalewavefields</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/Wavefields.jl#L251-L257">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.unscalewavefields-Tuple{DiffEqCallbacks.SavedValues}" href="#LongwaveModePropagator.unscalewavefields-Tuple{DiffEqCallbacks.SavedValues}"><code>LongwaveModePropagator.unscalewavefields</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">unscalewavefields(saved_values::SavedValues)</code></pre><p>Return the unscaled integrated wavefields originally scaled by <a href="#LongwaveModePropagator.scalewavefields"><code>scalewavefields</code></a>.</p><p>The bottom level does not get unscaled. We reference the higher levels to the bottom. The level above the bottom level is additionally scaled by the amount that was applied to originally get from this level down to the bottom level. The next level up (2 above the bottom level) is scaled by the amount applied to the next level and then the bottom level, i.e. we keep track of a cumulative correction on the way back up.</p><p>Assumes fields have been scaled by <a href="#LongwaveModePropagator.scalewavefields"><code>scalewavefields</code></a> during integration.</p><p>See also: <a href="#LongwaveModePropagator.unscalewavefields!-Tuple{Any, DiffEqCallbacks.SavedValues}"><code>unscalewavefields!</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/Wavefields.jl#L312-L326">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.Waveguide" href="#LongwaveModePropagator.Waveguide"><code>LongwaveModePropagator.Waveguide</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">Waveguide</code></pre><p>A waveguide propagation path with a background <code>BField</code>, ionosphere <code>Species</code>, and <code>Ground</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/Waveguides.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LongwaveModePropagator.adjoint-Tuple{HomogeneousWaveguide}" href="#LongwaveModePropagator.adjoint-Tuple{HomogeneousWaveguide}"><code>LongwaveModePropagator.adjoint</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">adjoint(w::HomogeneousWaveguide)</code></pre><p>Return <code>w</code> with an adjoint <code>BField</code> having an <code>x</code> component of opposite sign.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fgasdia/LongwaveModePropagator.jl/blob/833b1ffc5219474c071b456917de0922baaca248/src/Waveguides.jl#L35-L39">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../public/">« Public Interface</a><a class="docs-footer-nextpage" href="../../references/">References »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Thursday 10 June 2021 01:53">Thursday 10 June 2021</span>. Using Julia version 1.6.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
